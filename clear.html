<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Clear Site Data</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; padding: 2rem; background:#f6f8fa; color:#111; }
      .card { background:#fff; border:1px solid #e6e9ec; padding:1.25rem; border-radius:8px; max-width:680px; margin:2rem auto; box-shadow:0 4px 12px rgba(0,0,0,.04); }
      .ok { display:inline-block; margin-top:1rem; padding:.5rem .75rem; background:#D52B1E; color:#fff; border-radius:6px; text-decoration:none }
      pre { background:#0b1022; color:#c9d1d9; padding:.5rem; border-radius:6px; overflow:auto }
    </style>
  </head>
  <body>
    <div class="card">
      <h1>Clear site data</h1>
      <p>This page will clear localStorage, sessionStorage and non-HttpOnly cookies for this origin so previously saved quiz progress and stored answers are removed.</p>
      <p>Click the button below to clear now, or the page will automatically clear and redirect to the main page in a few seconds.</p>
      <p><button id="clearBtn" class="ok">Clear site data now</button></p>
      <p id="status" aria-live="polite"></p>
      <hr />
      <p>If you prefer to run this automatically after starting the server, open <code>/clear.html</code> once after the server starts.</p>
    </div>

    <script>
      function deleteCookie(name, path, domain) {
        let cookie = name + '=; Expires=Thu, 01 Jan 1970 00:00:00 GMT; Path=' + (path || '/') + ';';
        if (domain) cookie += ' Domain=' + domain + ';';
        document.cookie = cookie;
      }

      function deleteAllCookies() {
        const cookies = document.cookie.split(';').map(c => c.trim()).filter(Boolean);
        cookies.forEach(cookie => {
          const name = cookie.split('=')[0];
          // try common paths/domains
          deleteCookie(name, '/');
          deleteCookie(name, '', location.hostname);
          deleteCookie(name, '/', location.hostname);
        });
      }

      function clearAll() {
        try {
          // clear storage
          localStorage.clear();
          sessionStorage.clear();
        } catch(e) {}
        try {
          deleteAllCookies();
        } catch(e) {}
        const st = document.getElementById('status');
        st.textContent = 'Cleared localStorage, sessionStorage and accessible cookies.';
        // give user a moment to read then redirect to home
        setTimeout(() => { window.location.href = './'; }, 1200);
      }

      document.getElementById('clearBtn').addEventListener('click', clearAll);

      // Auto-run after a short delay so opening the page clears automatically
      setTimeout(clearAll, 1000);
    </script>
  </body>
</html>